# Прогноз оттока клиентов (Telco Customer Churn)

## Описание проекта
в этом проектк я решал проблему Отток клиентов, а именно делал EDA и создал модель.
Отток клиентов (churn) является одной из ключевых бизнес-проблем телекоммуникационных компаний, так как удержание существующих клиентов обычно дешевле, чем привлечение новых.
В данном проекте построен **end-to-end ML-пайплайн** для прогнозирования оттока клиентов на основе демографических данных, используемых услуг и условий контракта.

---

## Цель проекта

Построить модель машинного обучения, которая предсказывает:

* `Churn = 1` — клиент уйдёт
* `Churn = 0` — клиент останется

---

## Данные

* **Источник:** Telco Customer Churn (Kaggle)
* **Количество наблюдений:** 7 032
* **Количество признаков:** 20 входных признаков + 1 целевая переменная

### Целевая переменная

* `Churn` — бинарный признак оттока клиента.

---

## Признаки

### Числовые признаки

* `tenure` — количество месяцев, в течение которых клиент пользуется услугами
* `MonthlyCharges` — ежемесячная стоимость услуг
* `TotalCharges` — суммарные расходы клиента за весь период

### Категориальные признаки

* Демография: `gender`, `SeniorCitizen`, `Partner`, `Dependents`
* Услуги: `PhoneService`, `MultipleLines`, `InternetService`, `OnlineSecurity`, `OnlineBackup`,
  `DeviceProtection`, `TechSupport`, `StreamingTV`, `StreamingMovies`
* Контракт и оплата: `Contract`, `PaperlessBilling`, `PaymentMethod`

Признак `customerID` был удалён, так как не содержит полезной информации для прогнозирования.

---

## Разведочный анализ данных (EDA)

### Распределение целевой переменной

Целевая переменная `Churn` является несбалансированной:

* большинство клиентов не уходят,
* меньшая часть клиентов покидает компанию.

В связи с этим при оценке модели использовались метрики ROC-AUC и F1-score, а не только accuracy.

---

### Анализ числовых признаков

* `tenure` имеет скошенное распределение: значительная часть клиентов уходит в первые месяцы.
* `MonthlyCharges` демонстрирует широкий разброс значений, отражая разнообразие тарифов.
* `TotalCharges` сильно коррелирует с `tenure` и `MonthlyCharges`, так как является накопленной суммой.

После очистки данных аномальные значения и пропуски отсутствуют.

---

### Анализ категориальных признаков

Были проанализированы распределения категориальных признаков и уровень оттока в каждой категории.

Ключевые наблюдения:

* Клиенты с контрактом **Month-to-month** уходят значительно чаще.
* Наличие услуг **OnlineSecurity** и **TechSupport** снижает вероятность оттока.
* Пользователи **Fiber optic** интернета демонстрируют более высокий churn.
* Paperless Billing и оплата через Electronic Check связаны с повышенным оттоком.

Полученные зависимости согласуются с бизнес-логикой.

---

### Корреляционный анализ

* Сильная корреляция наблюдается между сервисными признаками (`OnlineSecurity`, `TechSupport`, `StreamingTV`, `StreamingMovies`).
* `TotalCharges` имеет высокую корреляцию с `tenure`, что ожидаемо.
* Признаки `Contract`, `OnlineSecurity` и `TechSupport` демонстрируют заметную отрицательную корреляцию с `Churn`.

Корреляционный анализ использовался для понимания данных, а не для отбора признаков.

---

## Предобработка данных

В проекте применены следующие шаги предобработки:

* Преобразование `TotalCharges` в числовой формат.
* Преобразование бинарных категориальных признаков в формат 0/1.
* One-Hot Encoding для многокатегориальных признаков.
* Масштабирование числовых признаков с помощью `StandardScaler`.
* Вся предобработка реализована внутри `scikit-learn Pipeline` для предотвращения утечек данных.

---

## Модель

### Базовая модель

* **Logistic Regression**

Модель логистической регрессии была выбрана в качестве интерпретируемого и устойчивого baseline-решения для задачи churn prediction.

---

## Оценка модели

### Метрики качества

* **ROC-AUC:** 0.836
* **Accuracy:** 0.81

```
Класс 0 (No Churn):
Precision: 0.85
Recall:    0.89
F1-score:  0.87

Класс 1 (Churn):
Precision: 0.65
Recall:    0.57
F1-score:  0.61
```

Модель демонстрирует хорошую способность различать классы и приемлемое качество на классе оттока.

---

## Структура проекта

```
Data/
├── raw/
│   └── WA_Fn-UseC_-Telco-Customer-Churn.csv
└── processed/
    └── Clean_Data.csv

notebooks/
├── 01_eda.ipynb
├── State of Categorical Variables according to Churn
├── heatmap
└── churn_histogram
```

* `Data/raw` — исходные данные
* `Data/processed` — очищенный и подготовленный датасет
* `notebooks/01_eda.ipynb` — полный разведочный анализ данных
* графики используются для визуального анализа и документации результатов

---

## Как запустить проект

```bash
pip install -r requirements.txt
python src/train.py
```

---

## Итог

В рамках проекта:

* реализован полный ML-пайплайн,
* проведён осмысленный EDA,
* построена и оценена базовая модель,
* соблюдены принципы предотвращения утечек данных.
